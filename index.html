<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Panel de Monitoreo ‚Äî Ci√©naga Grande</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #0f172a;
      color: #f1f5f9;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    h1 {
      font-size: 1.8rem;
      margin-bottom: 10px;
      text-align: center;
    }

    h2 {
      font-size: 1rem;
      font-weight: 400;
      text-align: center;
      color: #94a3b8;
      margin-bottom: 20px;
    }

    .dashboard {
      background: #1e293b;
      border-radius: 20px;
      padding: 30px;
      width: 90%;
      max-width: 1000px;
      box-shadow: 0 0 20px rgba(0,0,0,0.4);
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-gap: 30px;
    }

    .card {
      background: #0f172a;
      border-radius: 15px;
      padding: 20px;
      box-shadow: inset 0 0 8px rgba(255,255,255,0.05);
    }

    canvas {
      width: 100% !important;
      height: 300px !important;
    }

    .controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
    }

    button {
      background: #2563eb;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      color: white;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }

    button:hover {
      background: #1d4ed8;
    }

    .alert {
      text-align: center;
      margin-top: 10px;
      font-weight: bold;
    }

    .alert.red {
      color: #f87171;
    }

    .alert.green {
      color: #34d399;
    }

    footer {
      margin-top: 20px;
      color: #94a3b8;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <h1>üåä Panel de Monitoreo ‚Äî Ci√©naga Grande</h1>
  <h2>Simulaci√≥n en tiempo real de turbidez del agua (sedimentaci√≥n)</h2>

  <div class="dashboard">
    <div class="card">
      <canvas id="turbidezChart"></canvas>
    </div>

    <div class="card">
      <h3>Turbidez actual: <span id="turbidezValue">--</span> FTU</h3>
      <h4>Nivel del agua: <span id="nivelValue">--</span> m</h4>
      <h4>Estado: <span id="estado">Esperando datos...</span></h4>

      <div class="controls">
        <button id="startBtn">Iniciar</button>
        <button id="pauseBtn">Pausar</button>
        <button id="resetBtn">Reset</button>
      </div>
      <div class="alert" id="alerta"></div>
    </div>
  </div>

  <footer>Proyecto educativo ‚Äî Ingenier√≠a Ambiental + Software | Simulaci√≥n: Ci√©naga Grande de Santa Marta</footer>

  <script>
    const ctx = document.getElementById('turbidezChart');
    const turbidezChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [{
          label: 'Turbidez (FTU)',
          data: [],
          borderColor: '#3b82f6',
          tension: 0.3,
          borderWidth: 3,
          fill: true,
          backgroundColor: 'rgba(59,130,246,0.1)'
        }]
      },
      options: {
        scales: {
          y: {
            beginAtZero: true,
            max: 150,
            ticks: { color: '#cbd5e1' }
          },
          x: {
            ticks: { color: '#cbd5e1' }
          }
        },
        plugins: {
          legend: { labels: { color: '#e2e8f0' } }
        }
      }
    });

    let interval;
    let paused = false;
    let time = 0;

    function randomTurbidez() {
      // Simula turbidez con variaciones realistas
      return Math.max(10, Math.min(150, 50 + Math.sin(time / 5) * 30 + Math.random() * 20));
    }

    function updateData() {
      if (paused) return;

      const turbidez = randomTurbidez();
      const nivel = (Math.random() * 1 + 1.5).toFixed(2);
      const estado = turbidez > 70 ? 'Alta sedimentaci√≥n' : 'Normal';

      // Actualiza valores en pantalla
      document.getElementById('turbidezValue').textContent = turbidez.toFixed(1);
      document.getElementById('nivelValue').textContent = nivel;
      document.getElementById('estado').textContent = estado;

      // Cambia color de alerta
      const alerta = document.getElementById('alerta');
      if (turbidez > 70) {
        alerta.textContent = '‚ö†Ô∏è Alerta: Alta turbidez detectada';
        alerta.className = 'alert red';
      } else {
        alerta.textContent = '‚úÖ Agua en condiciones normales';
        alerta.className = 'alert green';
      }

      // Actualiza gr√°fico
      time++;
      turbidezChart.data.labels.push(time);
      turbidezChart.data.datasets[0].data.push(turbidez);
      if (turbidezChart.data.labels.length > 20) {
        turbidezChart.data.labels.shift();
        turbidezChart.data.datasets[0].data.shift();
      }
      turbidezChart.update();
    }

    document.getElementById('startBtn').onclick = () => {
      if (!interval) {
        interval = setInterval(updateData, 1000);
        paused = false;
      }
    };

    document.getElementById('pauseBtn').onclick = () => {
      paused = !paused;
      document.getElementById('pauseBtn').textContent = paused ? 'Reanudar' : 'Pausar';
    };

    document.getElementById('resetBtn').onclick = () => {
      clearInterval(interval);
      interval = null;
      time = 0;
      turbidezChart.data.labels = [];
      turbidezChart.data.datasets[0].data = [];
      turbidezChart.update();
      document.getElementById('turbidezValue').textContent = '--';
      document.getElementById('nivelValue').textContent = '--';
      document.getElementById('estado').textContent = 'Esperando datos...';
      document.getElementById('alerta').textContent = '';
    };
  </script>
</body>
</html>
